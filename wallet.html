<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Masterpass Wallet</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="https://img.icons8.com/ios-filled/50/000000/mastercard-logo.png" />
</head>
<body class="bg-gray-100 min-h-screen font-sans text-gray-800">
  <!-- Header -->
  <header class="bg-white shadow-md p-4 flex items-center justify-between">
    <div class="flex items-center space-x-2">
      <img src="https://img.icons8.com/color/48/000000/mastercard-logo.png" class="w-8 h-8" />
      <h1 class="text-lg font-semibold">masterpass <span class="text-xs text-gray-500">by mastercard</span></h1>
    </div>
    <button id="logoutBtn" class="text-red-500 hover:underline text-sm">Wyloguj się</button>
  </header>

  <!-- Main -->
  <main class="max-w-3xl mx-auto mt-8 p-4 bg-white shadow rounded">
    <h2 class="text-xl font-semibold mb-4">Twój portfel</h2>

    <!-- User Info -->
    <div class="mb-6">
      <p class="text-sm">Zalogowano jako: <span id="userEmail" class="font-medium"></span></p>
      <p class="text-sm">Saldo: <span id="userBalance" class="font-semibold text-green-600"></span> PLN</p>
    </div>

    <!-- Orders / Activity -->
    <div>
      <h3 class="text-lg font-semibold mb-2">Historia transakcji</h3>
      <table class="w-full text-sm table-auto border">
        <thead class="bg-gray-200">
          <tr>
            <th class="p-2 text-left">Data</th>
            <th class="p-2 text-left">Opis</th>
            <th class="p-2 text-right">Kwota</th>
          </tr>
        </thead>
        <tbody id="transactionTable">
          <!-- Dynamically inserted rows -->
        </tbody>
      </table>
    </div>

    <!-- Actions -->
    <div class="mt-6 flex gap-4">
      <button id="addFunds" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Dodaj środki</button>
      <button id="makePayment" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Zrealizuj płatność</button>
    </div>
  </main>

  <script>
    const user = JSON.parse(localStorage.getItem('user')) || { email: 'nieznany', balance: '0.00' };
    const transactionTable = document.getElementById('transactionTable');

    document.getElementById('userEmail').textContent = user.email;
    document.getElementById('userBalance').textContent = parseFloat(user.balance).toFixed(2);

    let balance = parseFloat(user.balance);
    const transactions = [
      { date: '2025-06-25', desc: 'Zakup w sklepie ABC', amount: -49.99 },
      { date: '2025-06-22', desc: 'Zwrot środków', amount: 50.00 },
      { date: '2025-06-20', desc: 'Doładowanie', amount: 100.00 }
    ];

    function renderTransactions() {
      transactionTable.innerHTML = '';
      transactions.forEach(tx => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="p-2">${tx.date}</td>
          <td class="p-2">${tx.desc}</td>
          <td class="p-2 text-right ${tx.amount < 0 ? 'text-red-600' : 'text-green-600'}">
            ${tx.amount < 0 ? '-' : '+'}${Math.abs(tx.amount).toFixed(2)} PLN
          </td>`;
        transactionTable.appendChild(row);
      });
    }

    document.getElementById('addFunds').addEventListener('click', () => {
      const amount = 50;
      balance += amount;
      transactions.unshift({ date: new Date().toISOString().slice(0, 10), desc: 'Doładowanie', amount });
      localStorage.setItem('user', JSON.stringify({ ...user, balance: balance.toFixed(2) }));
      document.getElementById('userBalance').textContent = balance.toFixed(2);
      renderTransactions();
    });

    document.getElementById('makePayment').addEventListener('click', () => {
      const amount = 30;
      if (balance >= amount) {
        balance -= amount;
        transactions.unshift({ date: new Date().toISOString().slice(0, 10), desc: 'Płatność usługa XYZ', amount: -amount });
        localStorage.setItem('user', JSON.stringify({ ...user, balance: balance.toFixed(2) }));
        document.getElementById('userBalance').textContent = balance.toFixed(2);
        renderTransactions();
      } else {
        alert('Niewystarczające środki!');
      }
    });

    document.getElementById('logoutBtn').addEventListener('click', () => {
      localStorage.removeItem('user');
      window.location.href = 'index.html';
    });

    renderTransactions();
  </script>
</body>
</html>
